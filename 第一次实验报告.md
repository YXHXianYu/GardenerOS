# 2022秋《操作系统》课程实验报告

> 实验1
>
> 21301114 俞贤皓

## 一、实验步骤

### 1. 准备实验基础平台

* 安装Docker
  * ![1](./第一次实验报告/1.png)

* 更换Docker镜像站
  * ![2](./第一次实验报告/2.png)

* 获取OpenEuler镜像
  * ![3](./第一次实验报告/3.png)

### 2. 创建本地开发目录

* 创建本地仓库并链接到github仓库
  * ![4](./第一次实验报告/4.png)

* Github结果
  * ![5](./第一次实验报告/5.png)

### 3. 创建自己的docker镜像

* 启动容器
  * ![6](./第一次实验报告/6.png)
* 修改容器名称
  * ![7](./第一次实验报告/7.png)
* 安装一些必要的工具
  * ![8](./第一次实验报告/8.png)
* 安装fish shell和配置
  * 尝试将docker的默认终端修改为fish
  * 但是发现attach docker时，实际上并不是使用docker内的shell，而是使用主机上的shell
  * 上网搜索后，发现需要使用DockerFile重新建立镜像
  * 过于麻烦，所以我直接写了一个 `startDocker.fish` 脚本，自动重启docker，并且以fish shell进入docker
  * ![9](./第一次实验报告/9.png)
* 导入vim配置
  * 装一下git，配置一下ssh，然后直接clone我的配置仓库，配置一下就可以了`git@github.com:YXHXianYu/YXHXianYu-vim.git`


### 4. 配置Rust开发环境

* 添加环境变量
  * 因为我用的是fish shell，所以我修改 `~/.config/fish/config.fish`
  * 然后发现docker还是蛮智能的，使用外部的shell进入，会自动调用对应shell的配置文件
  * ![image-20230915120801519](./第一次实验报告/image-20230915120801519.png)
* 安装rust
  * 遇到了 `curl(6): Curl could not resolve host` 的问题，搜索后发现需要修改 Docker 的 DNS
  * ![image-20230915122335635](./第一次实验报告/image-20230915122335635.png)
  * 修改后就正常运行了
  * ![image-20230915122550317](./第一次实验报告/image-20230915122550317.png)
* 将rust bin目录添加进环境变量
  * 因为fish执行不了bash的脚本，所以需要自己整一下，整完就好了
  * ![image-20230915123309379](./第一次实验报告/image-20230915123309379.png)
* 将rust版本改为nightly
  * ![image-20230915123429078](./第一次实验报告/image-20230915123429078.png)
* 切换cargo软件包镜像为tuna
  * ![image-20230915124451165](./第一次实验报告/image-20230915124451165.png)
* 安装一些Rust相关的软件包
  * ![image-20230915214605826](./第一次实验报告/image-20230915214605826.png)

* 限制rust的版本
  * ![image-20230915214740041](./第一次实验报告/image-20230915214740041.png)


### 5. 安装qemu

* 安装rpm-build
  * ![image-20230915215715483](./第一次实验报告/image-20230915215715483.png)
* 安装 Development Tools
  * ![image-20230915220423102](./第一次实验报告/image-20230915220423102.png)
* 安装glib2
  * ![image-20230915220505463](./第一次实验报告/image-20230915220505463.png)
* 安装glib2-devel
  * ![image-20230915220806720](./第一次实验报告/image-20230915220806720.png)
* 安装一系列包
  * ![image-20230915220806720](./第一次实验报告/image-20230915220941456.png)
* 通过源码安装qemu 5.2
  * ![image-20230915221209496](./第一次实验报告/image-20230915221209496.png)
* 解压、构建、验证
  * ![image-20230915222201023](./第一次实验报告/image-20230915222201023.png)
* 导出成新的镜像
  * ![image-20230915223631999](./第一次实验报告/image-20230915223631999.png)

## 二、思考问题

* 无

## 三、Git提交截图

![image-20230915225321819](./第一次实验报告/image-20230915225321819.png)

## 四、其他说明

这个实验太棒了，学到了很多东西，非常喜欢！

之前经常听说docker，但从来没用过，今天第一次接触docker，被docker的强大震撼到了。在一台电脑上配好环境，只需要把镜像传到另一个电脑上，另一台电脑的docker就可以提供一个环境直接运行镜像！相当于一个轻量化的虚拟机。

那docker+git+github这个工作流就很高效，我平常在宿舍用台式机，在教室用笔记本。原本还在想着，台式机环境懒得配了，以后os作业都在笔记本上写。而docker正好解决了我的这个问题 OvO
